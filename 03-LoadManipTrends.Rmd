---
output: html_document
editor_options: 
  chunk_output_type: console
---

# Getting Started {#DataManip3}

```{r tidyr3, echo = FALSE, message = FALSE, warning = FALSE}

library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=50), tidy = FALSE)

```

## Setup

The setup files will get you ready for your analysis. It loads you libraries, needed tables, created directories for your outputs, and assigns some parameter values. 

Also assign max year of the analysis. 

```{r setup}

max.yr <- 2023 #needs changes with each analysis
ID<- "dethier" #change this to your user ID. You will be prompted for a password. 

source("00-setup.R")

```

## Choose a collection to be downloaded and prepare the provincial basemap

```{r downloaddata, echo = TRUE, message = FALSE}

#list the collections
list.coll<-unique(anal.param$collection)
list.prot<-unique(anal.param$protocol_id)

#select your collection manually for data clearning
collection <- "ATOWLS"

```

## Output Tables

Create the output tables. This only needs to be done once per provincal analysis

```{r data manip}

source("i-output.R") #Total count period output tables

source("i-output2.R") #Silent listening period output tables

```


## Data manipulations 

```{r data manip}

source("ii-datamanip.R") #Total count period

source("ii-datamanip2.R") #Silent listening period

```

## Data Analysis iCAR

```{r analysis}

source("iii-icar.R")

```

## Data Analysis SPDE

```{r analysis}


#pull up the provincial basemap manually
canada <- rnaturalearth::ne_states(country = "canada", returnclass = "sf") %>% st_transform(epsg6703km) 
qq <- filter(canada, name %in% c("British Columbia"))

source("iv-spde.R")

```

## Plot Trends 

```{r Plot trends}

source("v_plots.R")

```

## Stitch together outputs for Catherine

```{r final outputs}



```